<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Interacting with the ECS S3 API using the aws-sdk/client-s3 package | Daniel Brennand</title><meta name=keywords content="Node.js,ECS,S3,aws-sdk,client-s3"><meta name=description content="Recently at work, a customer raised a ticket about programmatically interacting with UKCloud&rsquo;s Cloud Storage service.
 UKCloud&rsquo;s Cloud Storage service is an object storage solution based on Dell EMC Elastic Cloud Storage (ECS). Access is via a RESTful API, which also provides support for Amazon&rsquo;s S3 API.
UKCloud: Getting Started Guide for Cloud Storage 1 This ticket was interesting as the customer was using the @aws-sdk/client-s3 JavaScript package to upload images to the service."><meta name=author content="Daniel Brennand"><link rel=canonical href=https://danielbrennand.com/blog/aws-sdk-s3/><link crossorigin=anonymous href=/assets/css/stylesheet.min.c88963fe2d79462000fd0fb1b3737783c32855d340583e4523343f8735c787f0.css integrity="sha256-yIlj/i15RiAA/Q+xs3N3g8MoVdNAWD5FIzQ/hzXHh/A=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://danielbrennand.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://danielbrennand.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://danielbrennand.com/favicon-32x32.png><link rel=apple-touch-icon href=https://danielbrennand.com/apple-touch-icon.png><link rel=mask-icon href=https://danielbrennand.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.85.0"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Interacting with the ECS S3 API using the aws-sdk/client-s3 package"><meta property="og:description" content="Recently at work, a customer raised a ticket about programmatically interacting with UKCloud&rsquo;s Cloud Storage service.
 UKCloud&rsquo;s Cloud Storage service is an object storage solution based on Dell EMC Elastic Cloud Storage (ECS). Access is via a RESTful API, which also provides support for Amazon&rsquo;s S3 API.
UKCloud: Getting Started Guide for Cloud Storage 1 This ticket was interesting as the customer was using the @aws-sdk/client-s3 JavaScript package to upload images to the service."><meta property="og:type" content="article"><meta property="og:url" content="https://danielbrennand.com/blog/aws-sdk-s3/"><meta property="article:section" content="blog"><meta property="article:published_time" content="2021-12-07T10:13:42+00:00"><meta property="article:modified_time" content="2021-12-07T10:13:42+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Interacting with the ECS S3 API using the aws-sdk/client-s3 package"><meta name=twitter:description content="Recently at work, a customer raised a ticket about programmatically interacting with UKCloud&rsquo;s Cloud Storage service.
 UKCloud&rsquo;s Cloud Storage service is an object storage solution based on Dell EMC Elastic Cloud Storage (ECS). Access is via a RESTful API, which also provides support for Amazon&rsquo;s S3 API.
UKCloud: Getting Started Guide for Cloud Storage 1 This ticket was interesting as the customer was using the @aws-sdk/client-s3 JavaScript package to upload images to the service."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Blogs","item":"https://danielbrennand.com/blog/"},{"@type":"ListItem","position":3,"name":"Interacting with the ECS S3 API using the aws-sdk/client-s3 package","item":"https://danielbrennand.com/blog/aws-sdk-s3/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Interacting with the ECS S3 API using the aws-sdk/client-s3 package","name":"Interacting with the ECS S3 API using the aws-sdk\/client-s3 package","description":"Recently at work, a customer raised a ticket about programmatically interacting with UKCloud\u0026rsquo;s Cloud Storage service.\n UKCloud\u0026rsquo;s Cloud Storage service is an object storage solution based on Dell EMC Elastic Cloud Storage (ECS). Access is via a RESTful API, which also provides support for Amazon\u0026rsquo;s S3 API.\nUKCloud: Getting Started Guide for Cloud Storage 1 This ticket was interesting as the customer was using the @aws-sdk/client-s3 JavaScript package to upload images to the service.","keywords":["Node.js","ECS","S3","aws-sdk","client-s3"],"articleBody":"Recently at work, a customer raised a ticket about programmatically interacting with UKCloud‚Äôs Cloud Storage service.\n UKCloud‚Äôs Cloud Storage service is an object storage solution based on Dell EMC Elastic Cloud Storage (ECS). Access is via a RESTful API, which also provides support for Amazon‚Äôs S3 API.\nUKCloud: Getting Started Guide for Cloud Storage 1 This ticket was interesting as the customer was using the @aws-sdk/client-s3 JavaScript package to upload images to the service. Prior to this ticket, I hadn‚Äôt used this package before or have much experience with S3 object storage and programmatically interacting with it. In this blog post, I want to share my learnings and provide a couple of examples in Node.js for interacting with UKCloud‚Äôs Cloud Storage service using this package.\n [NOTE]\nIt is worth noting that the code examples in this post should work with any S3 object storage provider, just modify the endpoint and region!\n S3 Terminology Before we get started, it‚Äôs important to understand certain terminology around Amazon‚Äôs S3 API.\nObjects  An object is a file and any metadata that describes that file. Objects consist of object data and metadata. The metadata is a set of name-value pairs that describe the object. These pairs include some default metadata, such as the date last modified ‚Ä¶ You can also specify custom metadata at the time that the object is stored.\nAmazon Web Services: What is Amazon S3? 2Amazon Web Services: Uploading, downloading, and working with objects in Amazon S3 3 Object Keys üîë An object key (or key name) is a unique identifier of an object.\n Amazon Web Services: Creating object key names 4 An example of an object key could be Testing/Requirements.pdf or Accounting/Payslips.xls. Note that the object keys are prefixed with a directory.\nBuckets  A bucket is a container for objects‚Ä¶ Every object is contained in a bucket.\nAmazon Web Services: What is Amazon S3? 2 A bucket has a flat structure with no actual concept of directories however, you can prefix object keys with (sub)directories to create a directory structure üìÅ\nNow that‚Äôs out of the way, let‚Äôs begin interacting with the ECS S3 API using the @aws-sdk/client-s3 for JavaScript üòé\nPrerequisites Before starting, you will need the following:\n   Prerequisite Optional     Docker installed on your system. No   The S3 API endpoint for the object storage provider of your choice. In the examples I will be using UKCloud‚Äôs Cloud Storage endpoint: https://cas.cor00005.ukcloud.com. No   The object storage provider‚Äôs region name. In the examples I will be using: cor00005. No   A bucket created with an object storage provider of your choice. Yes - You can create one via the API however, for the examples I already had a bucket.   The object storage provider‚Äôs equivalent of an AccessKeyId and SecretAccessKey. No    Node.js Examples üë®‚Äçüíª The following packages are used in these examples:\n  @aws-sdk/client-s3 - Documentation.\n  @aws-sdk/s3-request-presigner - Documentation.\n  fs\n  Begin by creating two files: examples.mjs and dockerfile. Then, paste the snippet below into the dockerfile:\nFROM node:16-alpine RUN mkdir -p /usr/src/app \u0026\u0026 chown -R node:node /usr/src/app WORKDIR /usr/src/app RUN npm install @aws-sdk/client-s3@3.43.0 @aws-sdk/s3-request-presigner@3.44.0 COPY --chown=node:node examples.mjs examples.mjs USER node CMD [\"node\", \"examples.mjs\"]  [NOTE] Place the Node.js examples below into examples.mjs.\n Initialise the S3Client Start by initialising the S3Client by importing the required package:\nimport { S3Client } from '@aws-sdk/client-s3'; // Retrieve constants from environment variables const S3_ENDPOINT = process.env.S3_ENDPOINT; const REGION = process.env.REGION; const BUCKET_NAME = process.env.BUCKET_NAME; // Initialise client const client = new S3Client({ endpoint: S3_ENDPOINT, region: REGION, }); Sending Commands with the S3Client Now, let‚Äôs use the S3Client to create an object in a bucket. For this type of action use the PutObjectCommand:\nCreate an Object import { S3Client, PutObjectCommand } from '@aws-sdk/client-s3'; // ...  // Create an object (testObject.txt) prefixed with a directory (test-dir/) in a bucket try { await client.send( new PutObjectCommand({ Bucket: BUCKET_NAME, Key: 'test-dir/testObject.txt', Body: 'Uploaded test object.' }) ); console.log(`Successfully created object 'test-dir/testObject.txt' in the bucket '${BUCKET_NAME}'`); } catch (err) { console.error(`An error occurred creating object 'test-dir/testObject.txt' in the bucket '${BUCKET_NAME}': ${err}`); }; Let‚Äôs see if it works! üòÑ Build and run the container image:\ndocker build -t aws-sdk-s3:nodejs . # The aws-sdk looks for the environment variables # AWS_ACCESS_KEY_ID and AWS_SECRET_ACCESS_KEY automatically docker run --rm --name aws-sdk-s3 \\  -e S3_ENDPOINT=\"https://cas.cor00005.ukcloud.com\" \\  -e REGION=\"cor00005\" \\  -e BUCKET_NAME=\"db-bucket\" \\  -e AWS_ACCESS_KEY_ID=\"...\" \\  -e AWS_SECRET_ACCESS_KEY=\"...\" \\  aws-sdk-s3:nodejs # Output Successfully created object 'test-dir/testObject.txt' in the bucket 'db-bucket' üò± It worked! Congrats! You‚Äôve just created your first object in a bucket! üòé\nList and Get Objects Another action is to list objects in a bucket and get them. Here is an example I wrote for that:\nimport { S3Client, PutObjectCommand, ListObjectsCommand, GetObjectCommand } from '@aws-sdk/client-s3'; // ...  // List of all objects (max 1000) in a bucket try { var objects = await client.send( new ListObjectsCommand({ Bucket: BUCKET_NAME }) ); } catch (err) { console.error(`An error occurred listing objects for the bucket '${BUCKET_NAME}': ${err}`); }; // Iterate over objects in the bucket and perform GetObjectCommand try { for (const [index, object] of objects.Contents.entries()) { console.log(`${index}- Getting object: ${object.Key}`); const resp = await client.send( new GetObjectCommand({ Bucket: BUCKET_NAME, Key: object.Key }) ); console.log(`${index}- Object: ${object.Key}, ETag: ${resp.ETag}`); }; } catch (err) { console.error(`An error occurred getting objects for the bucket '${BUCKET_NAME}': ${err}`); }; Upload and Download Objects Uploading and downloading objects is done often, so below are examples I wrote for this:\n// ... import fs from 'fs'; // ...  // Create a file to be upload fs.writeFileSync('/usr/src/app/uploadfile.txt', 'Upload me!', (_) = { console.log(\"Successfully wrote file '/usr/src/app/uploadfile.txt'\"); }); // Upload an object (file) to a bucket try { // Load the contents of 'uploadfile.txt'  fs.readFile('/usr/src/app/uploadfile.txt', 'utf8', async function (_, data) { await client.send( new PutObjectCommand({ Bucket: BUCKET_NAME, Key: 'uploadfile.txt', Body: data }) ) console.log(`Successfully uploaded object '/usr/src/app/uploadfile.txt' to the bucket '${BUCKET_NAME}'`); }); } catch (err) { console.error(`An error occurred uploading object '/usr/src/app/uploadfile.txt' to the bucket '${BUCKET_NAME}': ${err}`); }; // Download an object (file) from a bucket try { const downloadFile = await client.send( new GetObjectCommand({ Bucket: BUCKET_NAME, Key: 'test-dir/testObject.txt' }) ); // Create a write stream  const writeStream = fs.createWriteStream('/usr/src/app/testObject.txt'); // Pipe the object's body to the write stream  downloadFile.Body.pipe(writeStream); console.log(`Successfully downloaded object 'testObject.txt' from the bucket '${BUCKET_NAME}'`); } catch (err) { console.error(`An error occurred downloading object 'test-dir/testObject.txt' from the bucket '${BUCKET_NAME}': ${err}`); }; Generate a Public URL for an Object The final example I want to share is generating a public URL for an object so it can be downloaded. The example below generates a URL valid for one hour:\n// ... import { getSignedUrl } from \"@aws-sdk/s3-request-presigner\"; /// ...  // Get a public URL for an object in a bucket // Valid for 1 hour try { const command = new GetObjectCommand({ Bucket: BUCKET_NAME, Key: 'uploadfile.txt' }); // Get public URL for the object  const publicUrl = await getSignedUrl(client, command, { expiresIn: 3600 }); console.log(`Successfully generated public URL for object 'test-dir/testObject.txt' in the bucket '${BUCKET_NAME}': ${publicUrl}`); } catch (err) { console.error(`An error occurred generating public URL for object 'test-dir/testObject.txt' in the bucket '${BUCKET_NAME}': ${err}`); }; The examples above and others that I wrote can be found on GitHub at: https://github.com/dbrennand/ecs-s3-examples/tree/nodejs/nodejs\nI hope you learned something from this blog post! Until next time! üòÑ üëã\nReferences   https://docs.ukcloud.com/articles/cloud-storage/cs-gs.html¬†‚Ü©Ô∏é\n https://docs.aws.amazon.com/AmazonS3/latest/userguide/Welcome.html¬†‚Ü©Ô∏é\n https://docs.aws.amazon.com/AmazonS3/latest/userguide/uploading-downloading-objects.html¬†‚Ü©Ô∏é\n https://docs.aws.amazon.com/AmazonS3/latest/userguide/object-keys.html¬†‚Ü©Ô∏é\n   ","wordCount":"1199","inLanguage":"en","datePublished":"2021-12-07T10:13:42Z","dateModified":"2021-12-07T10:13:42Z","author":{"@type":"Person","name":"Daniel Brennand"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://danielbrennand.com/blog/aws-sdk-s3/"},"publisher":{"@type":"Organization","name":"Daniel Brennand","logo":{"@type":"ImageObject","url":"https://danielbrennand.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script><header class=header><nav class=nav><div class=logo><a href=https://danielbrennand.com accesskey=h title="Daniel Brennand (Alt + H)">Daniel Brennand</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://danielbrennand.com/blog title=Blog><span>Blog</span></a></li><li><a href=https://danielbrennand.com/tags title=Tags><span>Tags</span></a></li><li><a href=https://danielbrennand.com/archives title=Archive><span>Archive</span></a></li><li><a href=https://ps2alert.me/ title="Personal Project: PS2Alert.me"><span>Personal Project: PS2Alert.me</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://danielbrennand.com>Home</a>&nbsp;¬ª&nbsp;<a href=https://danielbrennand.com/blog/>Blogs</a></div><h1 class=post-title>Interacting with the ECS S3 API using the aws-sdk/client-s3 package</h1><div class=post-meta><span title="2021-12-07 10:13:42 +0000 UTC">December 7, 2021</span>&nbsp;¬∑&nbsp;6 min&nbsp;¬∑&nbsp;Daniel Brennand</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#s3-terminology aria-label="S3 Terminology">S3 Terminology</a><ul><li><a href=#objects aria-label=Objects>Objects</a></li><li><a href=#object-keys- aria-label="Object Keys üîë">Object Keys üîë</a></li><li><a href=#buckets aria-label=Buckets>Buckets</a></li></ul></li><li><a href=#prerequisites aria-label=Prerequisites>Prerequisites</a></li><li><a href=#nodejs-examples- aria-label="Node.js Examples üë®‚Äçüíª">Node.js Examples üë®‚Äçüíª</a><ul><li><a href=#initialise-the-s3client aria-label="Initialise the S3Client">Initialise the S3Client</a></li><li><a href=#sending-commands-with-the-s3client aria-label="Sending Commands with the S3Client">Sending Commands with the S3Client</a><ul><li><a href=#create-an-object aria-label="Create an Object">Create an Object</a></li><li><a href=#list-and-get-objects aria-label="List and Get Objects">List and Get Objects</a></li><li><a href=#upload-and-download-objects aria-label="Upload and Download Objects">Upload and Download Objects</a></li><li><a href=#generate-a-public-url-for-an-object aria-label="Generate a Public URL for an Object">Generate a Public URL for an Object</a></li></ul></li></ul></li><li><a href=#references aria-label=References>References</a></li></ul></div></details></div><div class=post-content><p>Recently at work, a customer raised a ticket about programmatically interacting with <a href=https://docs.ukcloud.com/articles/cloud-storage/cs-gs.html>UKCloud&rsquo;s Cloud Storage service</a>.</p><blockquote><p>UKCloud&rsquo;s Cloud Storage service is an object storage solution based on Dell EMC Elastic Cloud Storage (ECS). Access is via a RESTful API, which also provides support for Amazon&rsquo;s S3 API.</p><p>UKCloud: Getting Started Guide for Cloud Storage <sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup></p></blockquote><p>This ticket was interesting as the customer was using the <a href=https://docs.aws.amazon.com/AWSJavaScriptSDK/v3/latest/clients/client-s3/index.html>@aws-sdk/client-s3</a> JavaScript package to upload images to the service. Prior to this ticket, I hadn&rsquo;t used this package before or have much experience with S3 object storage and programmatically interacting with it. In this blog post, I want to share my learnings and provide a couple of examples in Node.js for interacting with UKCloud&rsquo;s Cloud Storage service using this package.</p><blockquote><p>[NOTE]</p><p>It is worth noting that the code examples in this post <em>should</em> work with any S3 object storage provider, just modify the endpoint and region!</p></blockquote><h2 id=s3-terminology>S3 Terminology<a hidden class=anchor aria-hidden=true href=#s3-terminology>#</a></h2><p>Before we get started, it&rsquo;s important to understand certain terminology around Amazon&rsquo;s S3 API.</p><h3 id=objects>Objects<a hidden class=anchor aria-hidden=true href=#objects>#</a></h3><blockquote><p>An object is a file and any metadata that describes that file. Objects consist of object data and metadata. The metadata is a set of name-value pairs that describe the object. These pairs include some default metadata, such as the date last modified &mldr; You can also specify custom metadata at the time that the object is stored.</p><p>Amazon Web Services: What is Amazon S3? <sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup></p><p>Amazon Web Services: Uploading, downloading, and working with objects in Amazon S3 <sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup></p></blockquote><h3 id=object-keys->Object Keys üîë<a hidden class=anchor aria-hidden=true href=#object-keys->#</a></h3><p>An object key (or key name) is a unique identifier of an object.</p><blockquote><p>Amazon Web Services: Creating object key names <sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup></p></blockquote><p>An example of an object key could be <code>Testing/Requirements.pdf</code> or <code>Accounting/Payslips.xls</code>. Note that the object keys are prefixed with a directory.</p><h3 id=buckets>Buckets<a hidden class=anchor aria-hidden=true href=#buckets>#</a></h3><blockquote><p>A bucket is a container for objects&mldr; Every object is contained in a bucket.</p><p>Amazon Web Services: What is Amazon S3? <sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup></p></blockquote><p>A bucket has a flat structure with no actual concept of directories however, you can prefix object keys with (sub)directories to create a directory structure üìÅ</p><p>Now that&rsquo;s out of the way, let&rsquo;s begin interacting with the ECS S3 API using the @aws-sdk/client-s3 for JavaScript üòé</p><h2 id=prerequisites>Prerequisites<a hidden class=anchor aria-hidden=true href=#prerequisites>#</a></h2><p>Before starting, you will need the following:</p><table><thead><tr><th>Prerequisite</th><th>Optional</th></tr></thead><tbody><tr><td><a href=https://www.docker.com/>Docker</a> installed on your system.</td><td>No</td></tr><tr><td>The S3 API endpoint for the object storage provider of your choice. In the examples I will be using <a href=https://docs.ukcloud.com/articles/cloud-storage/cs-gs.html#api-endpoints>UKCloud&rsquo;s Cloud Storage endpoint</a>: <code>https://cas.cor00005.ukcloud.com</code>.</td><td>No</td></tr><tr><td>The object storage provider&rsquo;s region name. In the examples I will be using: <code>cor00005</code>.</td><td>No</td></tr><tr><td>A bucket created with an object storage provider of your choice.</td><td>Yes - You can create one via the API however, for the examples I already had a bucket.</td></tr><tr><td>The object storage provider&rsquo;s equivalent of an <code>AccessKeyId</code> and <code>SecretAccessKey</code>.</td><td>No</td></tr></tbody></table><h2 id=nodejs-examples->Node.js Examples üë®‚Äçüíª<a hidden class=anchor aria-hidden=true href=#nodejs-examples->#</a></h2><p>The following packages are used in these examples:</p><ul><li><p><a href=https://www.npmjs.com/package/@aws-sdk/client-s3>@aws-sdk/client-s3</a> - <a href=https://docs.aws.amazon.com/AWSJavaScriptSDK/v3/latest/clients/client-s3/index.html>Documentation</a>.</p></li><li><p><a href=https://www.npmjs.com/package/@aws-sdk/s3-request-presigner>@aws-sdk/s3-request-presigner</a> - <a href=https://docs.aws.amazon.com/AWSJavaScriptSDK/v3/latest/modules/_aws_sdk_s3_request_presigner.html>Documentation</a>.</p></li><li><p><a href=https://nodejs.org/api/fs.html>fs</a></p></li></ul><p>Begin by creating two files: <code>examples.mjs</code> and <code>dockerfile</code>. Then, paste the snippet below into the <code>dockerfile</code>:</p><pre><code>FROM node:16-alpine
RUN mkdir -p /usr/src/app &amp;&amp; chown -R node:node /usr/src/app
WORKDIR /usr/src/app
RUN npm install @aws-sdk/client-s3@3.43.0 @aws-sdk/s3-request-presigner@3.44.0
COPY --chown=node:node examples.mjs examples.mjs
USER node
CMD [&quot;node&quot;, &quot;examples.mjs&quot;]
</code></pre><blockquote><p>[NOTE]
Place the Node.js examples below into <code>examples.mjs</code>.</p></blockquote><h3 id=initialise-the-s3client>Initialise the S3Client<a hidden class=anchor aria-hidden=true href=#initialise-the-s3client>#</a></h3><p>Start by initialising the <code>S3Client</code> by importing the required package:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>S3Client</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;@aws-sdk/client-s3&#39;</span>;

<span style=color:#75715e>// Retrieve constants from environment variables
</span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>S3_ENDPOINT</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>process</span>.<span style=color:#a6e22e>env</span>.<span style=color:#a6e22e>S3_ENDPOINT</span>;
<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>REGION</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>process</span>.<span style=color:#a6e22e>env</span>.<span style=color:#a6e22e>REGION</span>;
<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>BUCKET_NAME</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>process</span>.<span style=color:#a6e22e>env</span>.<span style=color:#a6e22e>BUCKET_NAME</span>;

<span style=color:#75715e>// Initialise client
</span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>client</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>S3Client</span>({
    <span style=color:#a6e22e>endpoint</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>S3_ENDPOINT</span>,
    <span style=color:#a6e22e>region</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>REGION</span>,
});
</code></pre></div><h3 id=sending-commands-with-the-s3client>Sending Commands with the S3Client<a hidden class=anchor aria-hidden=true href=#sending-commands-with-the-s3client>#</a></h3><p>Now, let&rsquo;s use the <code>S3Client</code> to create an object in a bucket. For this type of action use the <code>PutObjectCommand</code>:</p><h4 id=create-an-object>Create an Object<a hidden class=anchor aria-hidden=true href=#create-an-object>#</a></h4><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>S3Client</span>, <span style=color:#a6e22e>PutObjectCommand</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;@aws-sdk/client-s3&#39;</span>;

<span style=color:#75715e>// ...
</span><span style=color:#75715e></span>
<span style=color:#75715e>// Create an object (testObject.txt) prefixed with a directory (test-dir/) in a bucket
</span><span style=color:#75715e></span><span style=color:#66d9ef>try</span> {
    <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>client</span>.<span style=color:#a6e22e>send</span>(
        <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>PutObjectCommand</span>({
            <span style=color:#a6e22e>Bucket</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>BUCKET_NAME</span>,
            <span style=color:#a6e22e>Key</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;test-dir/testObject.txt&#39;</span>,
            <span style=color:#a6e22e>Body</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Uploaded test object.&#39;</span>
        })
    );
    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>`Successfully created object &#39;test-dir/testObject.txt&#39; in the bucket &#39;</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>BUCKET_NAME</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;`</span>);
} <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>err</span>) {
    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>`An error occurred creating object &#39;test-dir/testObject.txt&#39; in the bucket &#39;</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>BUCKET_NAME</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;: </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>err</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>);
};
</code></pre></div><p>Let&rsquo;s see if it works! üòÑ Build and run the container image:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>docker build -t aws-sdk-s3:nodejs .
<span style=color:#75715e># The aws-sdk looks for the environment variables</span>
<span style=color:#75715e># AWS_ACCESS_KEY_ID and AWS_SECRET_ACCESS_KEY automatically</span>
docker run --rm --name aws-sdk-s3 <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    -e S3_ENDPOINT<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;https://cas.cor00005.ukcloud.com&#34;</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    -e REGION<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;cor00005&#34;</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    -e BUCKET_NAME<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;db-bucket&#34;</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    -e AWS_ACCESS_KEY_ID<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;...&#34;</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    -e AWS_SECRET_ACCESS_KEY<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;...&#34;</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    aws-sdk-s3:nodejs

<span style=color:#75715e># Output</span>
Successfully created object <span style=color:#e6db74>&#39;test-dir/testObject.txt&#39;</span> in the bucket <span style=color:#e6db74>&#39;db-bucket&#39;</span>
</code></pre></div><p>üò± It worked! Congrats! You&rsquo;ve just created your first object in a bucket! üòé</p><h4 id=list-and-get-objects>List and Get Objects<a hidden class=anchor aria-hidden=true href=#list-and-get-objects>#</a></h4><p>Another action is to list objects in a bucket and get them. Here is an example I wrote for that:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#66d9ef>import</span> {
    <span style=color:#a6e22e>S3Client</span>,
    <span style=color:#a6e22e>PutObjectCommand</span>,
    <span style=color:#a6e22e>ListObjectsCommand</span>,
    <span style=color:#a6e22e>GetObjectCommand</span>
} <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;@aws-sdk/client-s3&#39;</span>;

<span style=color:#75715e>// ...
</span><span style=color:#75715e></span>
<span style=color:#75715e>// List of all objects (max 1000) in a bucket
</span><span style=color:#75715e></span><span style=color:#66d9ef>try</span> {
    <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>objects</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>client</span>.<span style=color:#a6e22e>send</span>(
        <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>ListObjectsCommand</span>({ <span style=color:#a6e22e>Bucket</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>BUCKET_NAME</span> })
    );
} <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>err</span>) {
    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>`An error occurred listing objects for the bucket &#39;</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>BUCKET_NAME</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;: </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>err</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>);
};

<span style=color:#75715e>// Iterate over objects in the bucket and perform GetObjectCommand
</span><span style=color:#75715e></span><span style=color:#66d9ef>try</span> {
    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> [<span style=color:#a6e22e>index</span>, <span style=color:#a6e22e>object</span>] <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>objects</span>.<span style=color:#a6e22e>Contents</span>.<span style=color:#a6e22e>entries</span>()) {
        <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>index</span><span style=color:#e6db74>}</span><span style=color:#e6db74> - Getting object: </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>object</span>.<span style=color:#a6e22e>Key</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>);
        <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>resp</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>client</span>.<span style=color:#a6e22e>send</span>(
            <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GetObjectCommand</span>({
                <span style=color:#a6e22e>Bucket</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>BUCKET_NAME</span>,
                <span style=color:#a6e22e>Key</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>object</span>.<span style=color:#a6e22e>Key</span>
            })
        );
        <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>index</span><span style=color:#e6db74>}</span><span style=color:#e6db74> - Object: </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>object</span>.<span style=color:#a6e22e>Key</span><span style=color:#e6db74>}</span><span style=color:#e6db74>, ETag: </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>resp</span>.<span style=color:#a6e22e>ETag</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>);
    };
} <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>err</span>) {
    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>`An error occurred getting objects for the bucket &#39;</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>BUCKET_NAME</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;: </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>err</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>);
};
</code></pre></div><h4 id=upload-and-download-objects>Upload and Download Objects<a hidden class=anchor aria-hidden=true href=#upload-and-download-objects>#</a></h4><p>Uploading and downloading objects is done often, so below are examples I wrote for this:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#75715e>// ...
</span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>fs</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;fs&#39;</span>;

<span style=color:#75715e>// ...
</span><span style=color:#75715e></span>
<span style=color:#75715e>// Create a file to be upload
</span><span style=color:#75715e></span><span style=color:#a6e22e>fs</span>.<span style=color:#a6e22e>writeFileSync</span>(<span style=color:#e6db74>&#39;/usr/src/app/uploadfile.txt&#39;</span>, <span style=color:#e6db74>&#39;Upload me!&#39;</span>, (<span style=color:#ae81ff>_</span>) =&gt; {
    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#34;Successfully wrote file &#39;/usr/src/app/uploadfile.txt&#39;&#34;</span>);
});

<span style=color:#75715e>// Upload an object (file) to a bucket
</span><span style=color:#75715e></span><span style=color:#66d9ef>try</span> {
    <span style=color:#75715e>// Load the contents of &#39;uploadfile.txt&#39;
</span><span style=color:#75715e></span>    <span style=color:#a6e22e>fs</span>.<span style=color:#a6e22e>readFile</span>(<span style=color:#e6db74>&#39;/usr/src/app/uploadfile.txt&#39;</span>, <span style=color:#e6db74>&#39;utf8&#39;</span>, <span style=color:#66d9ef>async</span> <span style=color:#66d9ef>function</span> (<span style=color:#ae81ff>_</span>, <span style=color:#a6e22e>data</span>) {
        <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>client</span>.<span style=color:#a6e22e>send</span>(
            <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>PutObjectCommand</span>({
                <span style=color:#a6e22e>Bucket</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>BUCKET_NAME</span>,
                <span style=color:#a6e22e>Key</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;uploadfile.txt&#39;</span>,
                <span style=color:#a6e22e>Body</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>data</span>
            })
        )
        <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>`Successfully uploaded object &#39;/usr/src/app/uploadfile.txt&#39; to the bucket &#39;</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>BUCKET_NAME</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;`</span>);
    });
} <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>err</span>) {
    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>`An error occurred uploading object &#39;/usr/src/app/uploadfile.txt&#39; to the bucket &#39;</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>BUCKET_NAME</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;: </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>err</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>);
};

<span style=color:#75715e>// Download an object (file) from a bucket
</span><span style=color:#75715e></span><span style=color:#66d9ef>try</span> {
    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>downloadFile</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>client</span>.<span style=color:#a6e22e>send</span>(
        <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GetObjectCommand</span>({
            <span style=color:#a6e22e>Bucket</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>BUCKET_NAME</span>,
            <span style=color:#a6e22e>Key</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;test-dir/testObject.txt&#39;</span>
        })
    );
    <span style=color:#75715e>// Create a write stream
</span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>writeStream</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>fs</span>.<span style=color:#a6e22e>createWriteStream</span>(<span style=color:#e6db74>&#39;/usr/src/app/testObject.txt&#39;</span>);
    <span style=color:#75715e>// Pipe the object&#39;s body to the write stream
</span><span style=color:#75715e></span>    <span style=color:#a6e22e>downloadFile</span>.<span style=color:#a6e22e>Body</span>.<span style=color:#a6e22e>pipe</span>(<span style=color:#a6e22e>writeStream</span>);
    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>`Successfully downloaded object &#39;testObject.txt&#39; from the bucket &#39;</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>BUCKET_NAME</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;`</span>);
} <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>err</span>) {
    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>`An error occurred downloading object &#39;test-dir/testObject.txt&#39; from the bucket &#39;</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>BUCKET_NAME</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;: </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>err</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>);
};
</code></pre></div><h4 id=generate-a-public-url-for-an-object>Generate a Public URL for an Object<a hidden class=anchor aria-hidden=true href=#generate-a-public-url-for-an-object>#</a></h4><p>The final example I want to share is generating a public URL for an object so it can be downloaded. The example below generates a URL valid for one hour:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#75715e>// ...
</span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>getSignedUrl</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;@aws-sdk/s3-request-presigner&#34;</span>;

<span style=color:#75715e>/// ...
</span><span style=color:#75715e></span>
<span style=color:#75715e>// Get a public URL for an object in a bucket
</span><span style=color:#75715e>// Valid for 1 hour
</span><span style=color:#75715e></span><span style=color:#66d9ef>try</span> {
    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>command</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GetObjectCommand</span>({
        <span style=color:#a6e22e>Bucket</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>BUCKET_NAME</span>,
        <span style=color:#a6e22e>Key</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;uploadfile.txt&#39;</span>
    });
    <span style=color:#75715e>// Get public URL for the object
</span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>publicUrl</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>getSignedUrl</span>(<span style=color:#a6e22e>client</span>, <span style=color:#a6e22e>command</span>, { <span style=color:#a6e22e>expiresIn</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>3600</span> });
    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>`Successfully generated public URL for object &#39;test-dir/testObject.txt&#39; in the bucket &#39;</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>BUCKET_NAME</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;: </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>publicUrl</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>);
} <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>err</span>) {
    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>`An error occurred generating public URL for object &#39;test-dir/testObject.txt&#39; in the bucket &#39;</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>BUCKET_NAME</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;: </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>err</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>);
};
</code></pre></div><p>The examples above and others that I wrote can be found on GitHub at: <a href=https://github.com/dbrennand/ecs-s3-examples/tree/nodejs/nodejs>https://github.com/dbrennand/ecs-s3-examples/tree/nodejs/nodejs</a></p><p>I hope you learned something from this blog post! Until next time! üòÑ üëã</p><h2 id=references>References<a hidden class=anchor aria-hidden=true href=#references>#</a></h2><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p><a href=https://docs.ukcloud.com/articles/cloud-storage/cs-gs.html>https://docs.ukcloud.com/articles/cloud-storage/cs-gs.html</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2 role=doc-endnote><p><a href=https://docs.aws.amazon.com/AmazonS3/latest/userguide/Welcome.html>https://docs.aws.amazon.com/AmazonS3/latest/userguide/Welcome.html</a>&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3 role=doc-endnote><p><a href=https://docs.aws.amazon.com/AmazonS3/latest/userguide/uploading-downloading-objects.html>https://docs.aws.amazon.com/AmazonS3/latest/userguide/uploading-downloading-objects.html</a>&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4 role=doc-endnote><p><a href=https://docs.aws.amazon.com/AmazonS3/latest/userguide/object-keys.html>https://docs.aws.amazon.com/AmazonS3/latest/userguide/object-keys.html</a>&#160;<a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></div><footer class=post-footer><ul class=post-tags><li><a href=https://danielbrennand.com/tags/node.js/>Node.js</a></li><li><a href=https://danielbrennand.com/tags/ecs/>ECS</a></li><li><a href=https://danielbrennand.com/tags/s3/>S3</a></li><li><a href=https://danielbrennand.com/tags/aws-sdk/>aws-sdk</a></li><li><a href=https://danielbrennand.com/tags/client-s3/>client-s3</a></li></ul><nav class=paginav><a class=next href=https://danielbrennand.com/blog/cloudflare-ddns/><span class=title>Next Page ¬ª</span><br><span>Using Cloudflare as a Dynamic DNS (DDNS) provider</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Interacting with the ECS S3 API using the aws-sdk/client-s3 package on twitter" href="https://twitter.com/intent/tweet/?text=Interacting%20with%20the%20ECS%20S3%20API%20using%20the%20aws-sdk%2fclient-s3%20package&url=https%3a%2f%2fdanielbrennand.com%2fblog%2faws-sdk-s3%2f&hashtags=Node.js%2cECS%2cS3%2caws-sdk%2cclient-s3"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Interacting with the ECS S3 API using the aws-sdk/client-s3 package on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fdanielbrennand.com%2fblog%2faws-sdk-s3%2f&title=Interacting%20with%20the%20ECS%20S3%20API%20using%20the%20aws-sdk%2fclient-s3%20package&summary=Interacting%20with%20the%20ECS%20S3%20API%20using%20the%20aws-sdk%2fclient-s3%20package&source=https%3a%2f%2fdanielbrennand.com%2fblog%2faws-sdk-s3%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Interacting with the ECS S3 API using the aws-sdk/client-s3 package on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fdanielbrennand.com%2fblog%2faws-sdk-s3%2f&title=Interacting%20with%20the%20ECS%20S3%20API%20using%20the%20aws-sdk%2fclient-s3%20package"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Interacting with the ECS S3 API using the aws-sdk/client-s3 package on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fdanielbrennand.com%2fblog%2faws-sdk-s3%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Interacting with the ECS S3 API using the aws-sdk/client-s3 package on whatsapp" href="https://api.whatsapp.com/send?text=Interacting%20with%20the%20ECS%20S3%20API%20using%20the%20aws-sdk%2fclient-s3%20package%20-%20https%3a%2f%2fdanielbrennand.com%2fblog%2faws-sdk-s3%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Interacting with the ECS S3 API using the aws-sdk/client-s3 package on telegram" href="https://telegram.me/share/url?text=Interacting%20with%20the%20ECS%20S3%20API%20using%20the%20aws-sdk%2fclient-s3%20package&url=https%3a%2f%2fdanielbrennand.com%2fblog%2faws-sdk-s3%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2021 <a href=https://danielbrennand.com>Daniel Brennand</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById('menu');menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script><script>document.querySelectorAll('pre > code').forEach(b=>{const c=b.parentNode.parentNode,a=document.createElement('button');a.classList.add('copy-code'),a.innerText='copy';function d(){a.innerText='copied!',setTimeout(()=>{a.innerText='copy'},2e3)}a.addEventListener('click',e=>{if('clipboard'in navigator){navigator.clipboard.writeText(b.textContent),d();return}const a=document.createRange();a.selectNodeContents(b);const c=window.getSelection();c.removeAllRanges(),c.addRange(a);try{document.execCommand('copy'),d()}catch(a){}c.removeRange(a)}),c.classList.contains("highlight")?c.appendChild(a):c.parentNode.firstChild==c||(b.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?b.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(a):b.parentNode.appendChild(a))})</script></body></html>